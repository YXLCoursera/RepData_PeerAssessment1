<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Yaxin Li" />

<meta name="date" content="2026-02-11" />

<title>Reproducible Research: Peer Assessment 1 (Alternate Submission)</title>

<script src="PA1_template_files/header-attrs-2.30/header-attrs.js"></script>
<script src="PA1_template_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="PA1_template_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="PA1_template_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="PA1_template_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="PA1_template_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="PA1_template_files/navigation-1.1/tabsets.js"></script>
<link href="PA1_template_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="PA1_template_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="header">



<h1 class="title toc-ignore">Reproducible Research: Peer Assessment 1
(Alternate Submission)</h1>
<h4 class="author">Yaxin Li</h4>
<h4 class="date">February 11, 2026</h4>

</div>


<div id="loading-and-preprocessing-the-data" class="section level2">
<h2>Loading and preprocessing the data</h2>
<pre class="r"><code># Per instructions: activity.csv is in the same folder and not zipped
stopifnot(file.exists(&quot;activity.csv&quot;))

dat &lt;- read.csv(&quot;activity.csv&quot;, stringsAsFactors = FALSE)

# Parse/convert columns
dat$date &lt;- as.Date(dat$date)              # YYYY-MM-DD
dat$interval &lt;- as.integer(dat$interval)
dat$steps &lt;- as.numeric(dat$steps)

# Basic checks
str(dat)</code></pre>
<pre><code>## &#39;data.frame&#39;:    17568 obs. of  3 variables:
##  $ steps   : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ date    : Date, format: &quot;2012-10-01&quot; &quot;2012-10-01&quot; ...
##  $ interval: int  0 5 10 15 20 25 30 35 40 45 ...</code></pre>
<pre class="r"><code>summary(dat)</code></pre>
<pre><code>##      steps             date               interval     
##  Min.   :  0.00   Min.   :2012-10-01   Min.   :   0.0  
##  1st Qu.:  0.00   1st Qu.:2012-10-16   1st Qu.: 588.8  
##  Median :  0.00   Median :2012-10-31   Median :1177.5  
##  Mean   : 37.38   Mean   :2012-10-31   Mean   :1177.5  
##  3rd Qu.: 12.00   3rd Qu.:2012-11-15   3rd Qu.:1766.2  
##  Max.   :806.00   Max.   :2012-11-30   Max.   :2355.0  
##  NA&#39;s   :2304</code></pre>
<pre class="r"><code>head(dat, 10)</code></pre>
<pre><code>##    steps       date interval
## 1     NA 2012-10-01        0
## 2     NA 2012-10-01        5
## 3     NA 2012-10-01       10
## 4     NA 2012-10-01       15
## 5     NA 2012-10-01       20
## 6     NA 2012-10-01       25
## 7     NA 2012-10-01       30
## 8     NA 2012-10-01       35
## 9     NA 2012-10-01       40
## 10    NA 2012-10-01       45</code></pre>
</div>
<div id="what-is-mean-total-number-of-steps-taken-per-day"
class="section level2">
<h2>What is mean total number of steps taken per day?</h2>
<p>For this part of the assignment, missing values in <code>steps</code>
are ignored.</p>
<pre class="r"><code>dat_nonmissing &lt;- dat[!is.na(dat$steps), ]

daily_totals &lt;- aggregate(steps ~ date, data = dat_nonmissing, FUN = sum)
colnames(daily_totals) &lt;- c(&quot;date&quot;, &quot;total_steps&quot;)

head(daily_totals)</code></pre>
<pre><code>##         date total_steps
## 1 2012-10-02         126
## 2 2012-10-03       11352
## 3 2012-10-04       12116
## 4 2012-10-05       13294
## 5 2012-10-06       15420
## 6 2012-10-07       11015</code></pre>
<pre class="r"><code>summary(daily_totals$total_steps)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##      41    8841   10765   10766   13294   21194</code></pre>
<div id="histogram-of-the-total-number-of-steps-taken-each-day"
class="section level3">
<h3>Histogram of the total number of steps taken each day</h3>
<pre class="r"><code># Different look: colored histogram with borders
hist(
  daily_totals$total_steps,
  breaks = 18,
  col = &quot;#4C78A8&quot;,          # blue fill
  border = &quot;white&quot;,
  main = &quot;Distribution of Daily Step Totals (NAs Ignored)&quot;,
  xlab = &quot;Total steps per day&quot;,
  ylab = &quot;Frequency&quot;
)</code></pre>
<p><img src="figure/hist-daily-1.png" alt="" width="720" /></p>
</div>
<div id="mean-and-median-total-steps-per-day" class="section level3">
<h3>Mean and median total steps per day</h3>
<pre class="r"><code>mean_daily &lt;- mean(daily_totals$total_steps)
median_daily &lt;- median(daily_totals$total_steps)

mean_daily</code></pre>
<pre><code>## [1] 10766.19</code></pre>
<pre class="r"><code>median_daily</code></pre>
<pre><code>## [1] 10765</code></pre>
</div>
</div>
<div id="what-is-the-average-daily-activity-pattern"
class="section level2">
<h2>What is the average daily activity pattern?</h2>
<pre class="r"><code>avg_by_interval &lt;- aggregate(steps ~ interval, data = dat_nonmissing, FUN = mean)
colnames(avg_by_interval) &lt;- c(&quot;interval&quot;, &quot;avg_steps&quot;)

head(avg_by_interval)</code></pre>
<pre><code>##   interval avg_steps
## 1        0 1.7169811
## 2        5 0.3396226
## 3       10 0.1320755
## 4       15 0.1509434
## 5       20 0.0754717
## 6       25 2.0943396</code></pre>
<div id="time-series-plot-of-average-steps-across-all-days"
class="section level3">
<h3>Time series plot of average steps across all days</h3>
<pre class="r"><code># Different plot style: base line + points, custom colors
plot(
  avg_by_interval$interval,
  avg_by_interval$avg_steps,
  type = &quot;l&quot;,
  lwd = 2,
  col = &quot;#1B9E77&quot;,          # green line
  main = &quot;Average Steps per 5-minute Interval&quot;,
  xlab = &quot;5-minute interval&quot;,
  ylab = &quot;Average steps&quot;
)
points(
  avg_by_interval$interval,
  avg_by_interval$avg_steps,
  pch = 16,
  cex = 0.4,
  col = &quot;#1B9E77&quot;
)</code></pre>
<p><img src="figure/ts-avg-pattern-1.png" alt="" width="768" /></p>
</div>
<div
id="minute-interval-containing-the-maximum-number-of-steps-on-average"
class="section level3">
<h3>5-minute interval containing the maximum number of steps (on
average)</h3>
<pre class="r"><code>max_row &lt;- avg_by_interval[which.max(avg_by_interval$avg_steps), , drop = FALSE]
max_row</code></pre>
<pre><code>##     interval avg_steps
## 104      835  206.1698</code></pre>
</div>
</div>
<div id="imputing-missing-values" class="section level2">
<h2>Imputing missing values</h2>
<div id="total-number-of-missing-values-in-the-dataset"
class="section level3">
<h3>Total number of missing values in the dataset</h3>
<pre class="r"><code>n_missing &lt;- sum(is.na(dat$steps))
n_missing</code></pre>
<pre><code>## [1] 2304</code></pre>
</div>
<div id="imputation-strategy-and-new-dataset" class="section level3">
<h3>Imputation strategy and new dataset</h3>
<p><strong>Strategy (different attempt):</strong> impute missing
<code>steps</code> using the <strong>median</strong> number of steps for
the same <code>interval</code> (calculated over all non-missing
observations). This is simple and robust to spikes.</p>
<pre class="r"><code>median_by_interval &lt;- tapply(dat$steps, dat$interval, median, na.rm = TRUE)

dat_imp &lt;- dat
dat_imp$steps_imp &lt;- dat_imp$steps

miss_idx &lt;- is.na(dat_imp$steps_imp)
dat_imp$steps_imp[miss_idx] &lt;- median_by_interval[as.character(dat_imp$interval[miss_idx])]

# Confirm imputation worked
sum(is.na(dat_imp$steps_imp))</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="histogram-of-daily-totals-after-imputation"
class="section level3">
<h3>Histogram of daily totals after imputation</h3>
<pre class="r"><code>daily_totals_imp &lt;- aggregate(steps_imp ~ date, data = dat_imp, FUN = sum)
colnames(daily_totals_imp) &lt;- c(&quot;date&quot;, &quot;total_steps_imp&quot;)

head(daily_totals_imp)</code></pre>
<pre><code>##         date total_steps_imp
## 1 2012-10-01            1141
## 2 2012-10-02             126
## 3 2012-10-03           11352
## 4 2012-10-04           12116
## 5 2012-10-05           13294
## 6 2012-10-06           15420</code></pre>
<pre class="r"><code>summary(daily_totals_imp$total_steps_imp)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##      41    6778   10395    9504   12811   21194</code></pre>
<pre class="r"><code>hist(
  daily_totals_imp$total_steps_imp,
  breaks = 18,
  col = &quot;#F58518&quot;,          # orange fill
  border = &quot;white&quot;,
  main = &quot;Distribution of Daily Step Totals (After Imputation)&quot;,
  xlab = &quot;Total steps per day&quot;,
  ylab = &quot;Frequency&quot;
)</code></pre>
<p><img src="figure/hist-after-impute-1.png" alt="" width="720" /></p>
</div>
<div id="meanmedian-after-imputation-and-comparison"
class="section level3">
<h3>Mean/median after imputation and comparison</h3>
<pre class="r"><code>mean_daily_imp &lt;- mean(daily_totals_imp$total_steps_imp)
median_daily_imp &lt;- median(daily_totals_imp$total_steps_imp)

mean_daily_imp</code></pre>
<pre><code>## [1] 9503.869</code></pre>
<pre class="r"><code>median_daily_imp</code></pre>
<pre><code>## [1] 10395</code></pre>
<pre class="r"><code>impact &lt;- data.frame(
  Metric = c(&quot;Mean&quot;, &quot;Median&quot;),
  Before_Impute = c(mean_daily, median_daily),
  After_Impute  = c(mean_daily_imp, median_daily_imp),
  Difference    = c(mean_daily_imp - mean_daily,
                    median_daily_imp - median_daily)
)

impact</code></pre>
<pre><code>##   Metric Before_Impute After_Impute Difference
## 1   Mean      10766.19     9503.869   -1262.32
## 2 Median      10765.00    10395.000    -370.00</code></pre>
<pre class="r"><code># Nicely printed table (still fully reproducible)
knitr::kable(impact, digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Metric</th>
<th align="right">Before_Impute</th>
<th align="right">After_Impute</th>
<th align="right">Difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mean</td>
<td align="right">10766.19</td>
<td align="right">9503.87</td>
<td align="right">-1262.32</td>
</tr>
<tr class="even">
<td align="left">Median</td>
<td align="right">10765.00</td>
<td align="right">10395.00</td>
<td align="right">-370.00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div
id="are-there-differences-in-activity-patterns-between-weekdays-and-weekends"
class="section level2">
<h2>Are there differences in activity patterns between weekdays and
weekends?</h2>
<p>Use the <strong>imputed</strong> dataset for this section.</p>
<pre class="r"><code># Locale-independent weekday/weekend classification:
# as.POSIXlt()$wday: 0 = Sunday, ..., 6 = Saturday
wday &lt;- as.POSIXlt(dat_imp$date)$wday

dat_imp$day_type &lt;- ifelse(wday %in% c(0, 6), &quot;weekend&quot;, &quot;weekday&quot;)
dat_imp$day_type &lt;- factor(dat_imp$day_type, levels = c(&quot;weekday&quot;, &quot;weekend&quot;))

table(dat_imp$day_type)</code></pre>
<pre><code>## 
## weekday weekend 
##   12960    4608</code></pre>
<div
id="panel-plot-comparing-average-steps-per-interval-across-weekdays-and-weekends"
class="section level3">
<h3>Panel plot comparing average steps per interval across weekdays and
weekends</h3>
<pre class="r"><code>avg_int_day &lt;- aggregate(steps_imp ~ interval + day_type, data = dat_imp, FUN = mean)
colnames(avg_int_day) &lt;- c(&quot;interval&quot;, &quot;day_type&quot;, &quot;avg_steps_imp&quot;)

head(avg_int_day)</code></pre>
<pre><code>##   interval day_type avg_steps_imp
## 1        0  weekday    2.02222222
## 2        5  weekday    0.40000000
## 3       10  weekday    0.15555556
## 4       15  weekday    0.17777778
## 5       20  weekday    0.08888889
## 6       25  weekday    1.31111111</code></pre>
<pre class="r"><code># Different plotting system + color scheme: ggplot2 facets
library(ggplot2)

ggplot(avg_int_day, aes(x = interval, y = avg_steps_imp, color = day_type)) +
  geom_line(linewidth = 0.8) +
  facet_wrap(~ day_type, ncol = 1) +
  scale_color_manual(values = c(&quot;weekday&quot; = &quot;#4C78A8&quot;, &quot;weekend&quot; = &quot;#E45756&quot;)) +
  labs(
    title = &quot;Average Steps per 5-minute Interval: Weekdays vs Weekends&quot;,
    x = &quot;5-minute interval&quot;,
    y = &quot;Average steps (imputed dataset)&quot;,
    color = &quot;Day type&quot;
  ) +
  theme_minimal(base_size = 12) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="figure/panel-plot-1.png" alt="" width="864" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
